$(document).ready((function(){var n,o="",i="",c="",l="",u=[];function r(e){$("#"+e).find("option").remove();let t=document.createElement("option");t.text="Pilih",t.value="",$("#"+e).append(t)}Swal.mixin({customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-danger"},buttonsStyling:!1}).fire({title:"Perhatian",text:"Disarankan menggunakan perangkat dengan ukuran layar cukup lebar, minimal seukuran tablet atau smartphone dengan layar yang cukup lebar agar data dapat ditampilkan sebagaimana mestinya.",icon:"info",showCancelButton:!1,confirmButtonText:"Ok",cancelButtonText:"No, cancel!",reverseButtons:!0}),$.get("data/00_kecamatan.json",(function(e){o=e})),$.get("data/00_kelurahan.json",(function(e){i=e})),$.get("data/00_tahapan.json",(function(e){for(var t=0;t<e.length;t++){let n=document.createElement("option");n.value=e[t].isi,n.text=e[t].teks,$("#cmb_tahapan").append(n)}})),$(window).resize((function(){$(".dataTables_scrollBody").css("height",$(window).height()-200)})),n=$("#dps-table").DataTable({scrollY:$(window).height()-500,scrollCollapse:!0,fixedHeader:!0}),$("#cmb_tahapan").change((function(){$("#byname-title").html($("#cmb_tahapan").find(":selected").text().toUpperCase()+"<br>"+"PEMILIHAN UMUM TAHUN 2024"),r("cmb_kec"),r("cmb_kel"),r("cmb_tps"),function(){for(var e=0;e<o.length;e++){let t=document.createElement("option");t.value=o[e].kode,t.text=o[e].nama,$("#cmb_kec").append(t)}}(),l=$(this).val(),$.get("data/"+l+"/00_tps.json",(function(e){c=e}))})),$("#cmb_kec").change((function(){u=[],r("cmb_kel"),r("cmb_tps"),function(e){for(var t=0;t<i.length;t++)if(i[t].kode_kec==e){let e=document.createElement("option");e.value=i[t].kode_kel,e.text=i[t].nama,$("#cmb_kel").append(e)}}($(this).val()),$.get("data/"+l+"/"+$(this).find(":selected").text()+".json",(function(e){u.push(e)})),console.log(u)})),$("#cmb_kel").change((function(){r("cmb_tps"),function(e,t){for(var n=0;n<c.length;n++)if(c[n].KECAMATAN==e&&c[n].KELURAHAN==t){let e=document.createElement("option");e.text=c[n].TPS,$("#cmb_tps").append(e)}}($("#cmb_kec").find(":selected").text(),$(this).find(":selected").text())})),$("#cmb_tps").change((function(){if(""!=$(this).val()){Swal.fire({position:"center",icon:"info",title:"Tunggu sebentar, data sedang dimuat. Tunggu hingga data yang ditampilkan berubah.",showConfirmButton:!1,timer:2500});let o=u;e=$("#cmb_kec").find(":selected").text(),t=$("#cmb_kel").find(":selected").text(),a=$(this).val(),$("#filename").val("NGANJUK-"+e+"-"+t.replace(" ","_")+"-TPS_"+a+".pdf"),function(e,t,a){console.log(e),n.clear();let o=1;for(var i=0;i<e[0].length;i++)e[0][i].KELURAHAN==t&&e[0][i].TPS==a&&(n.row.add([o,e[0][i].NAMA,e[0][i].KELAMIN,e[0][i].USIA,e[0][i].KELURAHAN,e[0][i].RT,e[0][i].RW,"-"]).draw(),o+=1)}(o,t,a),console.clear()}else Swal.fire({position:"center",icon:"error",title:"Silahkan pilih nomor TPS",showConfirmButton:!1,timer:2500})})),$("#btn-unduh").click((function(){""==$("#cmb_kec").val()||""==$("#cmb_kel").val()||""==$("#cmb_tps").val()?alert("Pilih tahapan, kecamatan, desa/kelurahan, dan nomor tps terlebih dahulu untuk mengunduh data"):$.get("data/"+l+"/00_url.json",(function(e){for(var t=0;t<e.length;t++)e[t].NAMAFILE==$("#filename").val()&&window.open(e[t].URL)}))})),$("#btn-unduh-sk").click((function(){""==$("#cmb_tahapan").val()?alert("Pilih tahapan terlebih dahulu untuk mengunduh SK Penetapan"):$.get("data/"+l+"/00_url.json",(function(e){window.open(e[0].URL)}))})),$("#btn-unduh-ba").click((function(){""==$("#cmb_tahapan").val()?alert("Pilih tahapan terlebih dahulu untuk mengunduh BA Rekapitulasi dan Penetapan"):$.get("data/"+l+"/00_url.json",(function(e){window.open(e[1].URL)}))}))}));
